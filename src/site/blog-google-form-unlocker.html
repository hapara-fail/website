<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Escaping the Sandbox: The Google Form Unlocker | hapara.fail Blog</title>
    <link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/images/favicon.svg" />
    <link rel="shortcut icon" href="/images/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="hapara.fail" />
    <link rel="manifest" href="/images/site.webmanifest" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/universal.css">
    <link rel="stylesheet" href="/css/article.css">
</head>
<body>

    <header class="main-header">
        <a href="/" class="logo" aria-label="hapara.fail Homepage">hapara.fail</a>
        <button class="hamburger-menu" aria-label="Open navigation menu" aria-controls="site-drawer" aria-expanded="false">
            <span class="line"></span>
            <span class="line"></span>
            <span class="line"></span>
        </button>
    </header>

    <div class="nav-overlay" data-nav-overlay hidden></div>
    <nav class="nav-drawer" id="site-drawer" aria-label="Main menu" data-nav-drawer hidden></nav>

    <main>
        <section class="article-hero">
            <div class="parallax-bg"></div>
            <div class="container reveal-item reveal-up">
                <h1 class="gradient-text">Escaping the Sandbox: The Google Form Unlocker</h1>
                <div class="article-meta">
                    By <span>newark</span> &bull; Published on September 10, 2025
                </div>
            </div>
        </section>

        <article class="article-body container">
            <div class="reveal-item reveal-up">
                <p>Google Forms' "locked mode" is a familiar hurdle for many students, designed to turn a Chromebook into a secure, single-app kiosk for tests and quizzes. It appears robust, but its security relies heavily on the browser (the client) correctly enforcing the lockdown. This write-up explores the vulnerability that allows us to bypass this client-side control by intercepting the process and manually reconstructing the request for the form itself.</p>
            </div>
            
            <div class="reveal-item reveal-up">
                <h2>The Lobby and the Key</h2>
                <p>When you first open a locked form, you aren't seeing the test itself. You're in a pre-form "lobby" page. The purpose of this page is to trigger the browser's locked mode. Only after the browser is secured does it make a second request to Google's servers to fetch the actual form content.</p>
                <p>The critical flaw lies here: all the information required to make that second request is embedded directly in the source code of the lobby page. Specifically, it's contained within a JavaScript variable:</p>
                <code>_docs_flag_initialData</code>
                <p>This variable is a JSON object that holds a treasure trove of session data, including everything we need to bypass the lock.</p>
            </div>

            <div class="reveal-item reveal-up">
                <h2>Deconstructing the Data</h2>
                <p>By inspecting the page source (<code>view-source:</code>) of the lobby page, we can find and parse this JSON object. From it, we extract two essential pieces of data:</p>
                <ol>
                    <li>A security <strong>token</strong>, found at <code>info_params.token</code>.</li>
                    <li>The form's submission <strong>path</strong>, found at <code>"docs-crp"</code>.</li>
                </ol>
                <p>The token acts as a single-use key, and the path is the address of the locked door. The JavaScript logic to extract them is straightforward:</p>
                <pre><code>// 1. Find and parse the initialData JSON from the page source
const info_map = JSON.parse(_docs_flag_initialData);

// 2. Extract the two critical pieces of information
const token = info_map.info_params.token;
const formPath = info_map["docs-crp"]; // e.g., "/forms/d/e/.../formResponse"</code></pre>
            </div>

            <div class="reveal-item reveal-up">
                <h2>Forging the Request</h2>
                <p>With the token and path in hand, we have everything a legitimate, locked-down browser would use to fetch the form. The final step is to impersonate that browser.</p>
                <p>We can do this by programmatically creating a hidden HTML <code>&lt;form&gt;</code> element. We set its <code>action</code> attribute to the full Google Forms URL (constructed using our extracted <code>formPath</code>) and its <code>method</code> to <code>POST</code>. Inside this form, we create a hidden <code>&lt;input&gt;</code> and place our extracted <code>token</code> inside it. Triggering <code>form.submit()</code> sends this forged request to Google's servers.</p>
            </div>
            
            <div class="reveal-item reveal-up">
                <h2>The Flaw: Trusting the Client</h2>
                <p>This entire process works because of a classic vulnerability: insufficient server-side validation. The server trusted the client to be in a locked state, without performing its own check to verify it.</p>
                <blockquote>
                    Imagine a secure office building. To get a sensitive file from the mailroom (the Google Form), you're supposed to first pass through a full-body security scanner (locked mode). The lobby's front desk, however, leaves an internal memo for you (the page source). This memo contains the mailroom's direct extension number (the path) and a secret daily pickup code (the token).<br><br>Instead of going through the scanner, you simply read the memo, step outside, call the mailroom's direct line from your cell phone, and provide the correct pickup code. The mailroom clerk, seeing the valid code, assumes you've already been cleared by security and sends the file out to you via courier, completely bypassing the intended procedure.
                </blockquote>
                <p>Our tool acts as that outside caller. It reads the "memo," extracts the necessary credentials, and makes the request directly, tricking the server into thinking the client had already done its part.</p>
                
                <a href="/blog" class="back-link">&larr; Back to Blog</a>
                <div class="credits">
                    Original method discovery by @sprinkzmc in TitaniumNetwork.
                </div>
            </div>
        </article>
    </main>

    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="https://discord.gg/KA66dHUF4P" target="_blank" rel="noopener noreferrer" aria-label="Discord"><svg viewBox="0 0 24 24"><path d="M20.317 4.492c-1.53-.69-3.17-1.2-4.885-1.49a.075.075 0 0 0-.079.036c-.21.369-.444.85-.608 1.23a18.566 18.566 0 0 0-5.487 0 12.36 12.36 0 0 0-.617-1.23A.077.077 0 0 0 8.562 3c-1.714.29-3.354.8-4.885 1.491a.07.07 0 0 0-.032.027C.533 9.093-.32 13.555.099 17.961a.08.08 0 0 0 .031.055 20.03 20.03 0 0 0 5.993 2.98.078.078 0 0 0 .084-.026 13.83 13.83 0 0 0 1.226-1.963.074.074 0 0 0-.041-.104 13.201 13.201 0 0 1-1.872-.878.075.075 0 0 1-.008-.125c.126-.093.252-.19.372-.287a.075.075 0 0 1 .078-.01c3.927 1.764 8.18 1.764 12.061 0a.075.075 0 0 1 .079.009c.12.098.245.195.372.288a.075.075 0 0 1-.006.125c-.598.344-1.22.635-1.873.877a.075.075 0 0 0-.041.105c.36.687.772 1.341 1.225 1.962a.077.077 0 0 0 .084.028 19.963 19.963 0 0 0 6.002-2.981.076.076 0 0 0 .032-.054c.5-5.094-.838-9.52-3.549-13.442a.06.06 0 0 0-.031-.028zM8.02 15.278c-1.182 0-2.157-1.069-2.157-2.38 0-1.312.956-2.38 2.157-2.38 1.21 0 2.176 1.077 2.157 2.38 0 1.312-.956 2.38-2.157 2.38zm7.975 0c-1.183 0-2.157-1.069-2.157-2.38 0-1.312.955-2.38 2.157-2.38 1.21 0 2.176 1.077 2.157 2.38 0 1.312-.946 2.38-2.157 2.38z"/></svg></a>
                <a href="https://github.com/hapara-fail" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
                <a href="mailto:support@hapara.fail" aria-label="Email"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg></a>
            </div>
            <p class="footer-copy">&copy; 2025 hapara.fail<br>People over profits.</p>
            <p class="footer-legal"><a href="/terms">Terms</a> • <a href="/privacy">Privacy</a> • <a href="https://license.hapara.fail/">License</a> • <a href="https://status.hapara.fail/">Status</a></p>
        </div>
    </footer>
    
    <div class="cookie-notice" id="cookieNotice" role="dialog" aria-live="polite" aria-label="Cookie notice">
        <div class="cookie-content">
            <svg xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 256 256" aria-hidden="true"><title>Cookie SVG Icon</title><path fill="currentColor" d="M164.49 163.51a12 12 0 1 1-17 0a12 12 0 0 1 17 0m-81-8a12 12 0 1 0 17 0a12 12 0 0 0-16.98 0Zm9-39a12 12 0 1 0-17 0a12 12 0 0 0 17-.02Zm48-1a12 12 0 1 0 0 17a12 12 0 0 0 0-17M232 128A104 104 0 1 1 128 24a8 8 0 0 1 8 8a40 40 0 0 0 40 40a8 8 0 0 1 8 8a40 40 0 0 0 40 40a8 8 0 0 1 8 8m-16.31 7.39A56.13 56.13 0 0 1 168.5 87.5a56.13 56.13 0 0 1-47.89-47.19a88 88 0 1 0 95.08 95.08"/></svg>
            <p>We only use functional cookies to enhance your experience. No tracking, no ads. Ever.</p>
        </div>
        <button class="cookie-button" id="acceptCookie" aria-label="Accept cookies">Okay</button>
    </div>

    <script src="/js/nav.js" defer></script>
    <script src="/js/scroll-reveal.js"></script>
    <script src="/js/cookie-notice.js"></script>

</body>
</html>